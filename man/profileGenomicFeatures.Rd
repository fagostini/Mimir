% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/profileGenomicFeatures.R
\name{profileGenomicFeatures}
\alias{profileGenomicFeatures}
\title{Calculate metadata profiles across genomic features}
\usage{
profileGenomicFeatures(genomicRegions = NULL, sampleObject = NULL,
  TxDb = NULL, bins = c(100, 100, 100, 100), weightCol = NULL,
  ignoreStrand = FALSE, dropEmpty = TRUE, normType = c("density",
  "max", "none"), collapse = TRUE, verbose = TRUE)
}
\arguments{
\item{genomicRegions}{A named list of \code{\link[GenomicRanges:GRangesList-class]{GenomicRanges}} objects.}

\item{sampleObject}{A \code{\link[GenomicRanges:GRanges-class]{GenomicRanges}} or \code{\link[GenomicAlignments:GAlignments-class]{GenomicAlignments}} object.}

\item{TxDb}{A \code{\link[GenomicFeatures:TxDb-class]{GenomicFeatures}} object. Required if \code{genomicRegions} is not provided. It must contain \code{\link[GenomeInfoDb:Seqinfo-class]{GenomeInfoDb}} information.}

\item{bins}{An ordered integer vector (must be greater equal that the length of \code{genomicRegions}), or 3 if the latter is not provided. The vector order determines the number of bins for each region. If more bins than regions are provided, the additional will be ignored. Default order: Upstream, Exon, Downstream, Intron.}

\item{weightCol}{A single character string. This must be the name of an integer column in the \code{sampleObject} object.}

\item{ignoreStrand}{When set to 'TRUE', the strand information in \code{sampleObject} is ignored. This does not affect the features in \code{genomicRegions}.}

\item{dropEmpty}{When set to 'TRUE', the transcripts with no signal in any of their sub-regions will be discarded. When set to 'FALSE', all values of these regions will be set to 0.}

\item{normType}{A character string indicating which region normalising method to use. One of 'density' (default), 'max', 'none': can be abbreviated.
Depending on the chosen method the values of each region are normalised using the sum ('density'), the maximum ('max') of the values across the region, or not normalised at all ('none').}

\item{collapse}{When set to 'TRUE', the profiles are collapsed into a single profile.}

\item{verbose}{When set to 'TRUE', the function prints diagnostic messages.}
}
\value{
A \code{\link[data.table:data.table-class]{data.table}} of the normalised binned coverage across the genomic features. Column names are determined by \code{collapse}.
}
\description{
This function calculates metadata profiles across genomic features using a procedure similar to that used in (https://www.sciencedirect.com/science/article/pii/S1097276519303533?via%3Dihub#fig1)[Viphakone et al., 2019].
}
\examples{
library("TxDb.Dmelanogaster.UCSC.dm3.ensGene")
TxDb = TxDb.Dmelanogaster.UCSC.dm3.ensGene

query = extractGenomicFeatures(TxDb)

library("pasillaBamSubset")
library("GenomicAlignments")

fl1 <- untreated1_chr4()
subject = readGAlignments(fl1)

profile = profileGenomicFeatures(genomicRegions=query, sampleObject=subject, TxDb=TxDb)

library("ggplot2")

ggplot(profile, aes(x=bin, y=Mean, colour=region_id)) + 
  geom_line() +
  geom_vline(xintercept=c(100.5, 200.5), linetype="dashed", colour="grey30") +
  scale_x_continuous("Relative position",
       breaks=c(1, 100.5, 200.5, 300), label=c("-1000", "TSS", "TES", "1000")) +
  scale_y_continuous("Average normalised signal") +
  coord_cartesian(xlim=c(0, 300)) +
  theme_bw() +
  theme(legend.position=c(0.9, 0.8), legend.background=element_blank()) +
  guides(colour=guide_legend(title=""))
}
